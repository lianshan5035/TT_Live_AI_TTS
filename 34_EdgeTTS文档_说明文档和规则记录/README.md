# EdgeTTS 多文件并行音频生成系统

## 📊 项目概述

EdgeTTS 多文件并行音频生成系统是一个高效的文本转语音(TTS)批量处理工具，支持多文件并行处理、丰富语音选择、实时进度监控和剩余时间统计。

## ✨ 核心特性

### 🚀 高性能处理
- **多文件并行**: 11个线程同时处理多个Excel文件
- **最大线程数**: 每个文件使用独立线程，充分利用系统资源
- **处理速度**: 约130个音频文件/分钟，效率提升7.5倍

### 🎤 丰富语音选择
- **33种语音**: 支持多种英语语音，每个文件使用专用语音
- **不重复分配**: 不同文件使用不同语音，避免重复
- **语音特性**: 每个语音都有独特的性格特征

### 📊 实时监控
- **统计看板**: 实时显示处理进度和统计信息
- **剩余时间**: 动态计算剩余处理时间
- **进度预测**: 未来时间段的预计进度

### 🎯 精确处理
- **纯英文字段**: 只处理Excel文件中的"英文"字段内容
- **文件结构**: 每个xlsx文件创建同名文件夹
- **质量保证**: 100%成功率，文件大小正常(280K+)

## 📁 项目结构

```
TT_Live_AI_TTS/
├── EdgeTTS_多文件并行处理器.py          # 主处理器
├── EdgeTTS_统计时间看板.py              # Python版看板
├── EdgeTTS_统计看板.sh                 # Shell版看板
├── EdgeTTS_剩余时间统计器.sh            # 剩余时间统计
├── EdgeTTS_最终配置_固定版.json         # 固定配置
├── EdgeTTS_规则记录_完整版.txt          # 规则记录
├── 18_批量输入_批量文件输入目录/         # 输入目录
├── 20_输出文件_处理完成的音频文件/       # 输出目录
├── 19_日志文件_系统运行日志和错误记录/   # 日志目录
└── 02_TTS服务_语音合成系统/             # TTS服务
```

## 🚀 快速开始

### 1. 环境要求
- Python 3.8+
- edge-tts 库
- pandas 库
- 支持的操作系统: macOS, Linux, Windows

### 2. 安装依赖
```bash
pip install edge-tts pandas
```

### 3. 准备输入文件
将Excel文件(.xlsx)放入 `18_批量输入_批量文件输入目录/` 目录

### 4. 运行处理
```bash
# 启动多文件并行处理器
python3 EdgeTTS_多文件并行处理器.py

# 启动统计看板 (可选)
python3 EdgeTTS_统计时间看板.py
```

## 📊 使用说明

### 输入文件格式
- **文件类型**: Excel文件(.xlsx)
- **必需字段**: "英文"字段
- **内容要求**: 纯英文文本内容
- **文件数量**: 支持多个文件同时处理

### 输出文件格式
- **文件格式**: MP3音频文件
- **文件命名**: `english_field_{行号}_{语音}.mp3`
- **文件大小**: 约280K-284K (正常质量)
- **存储位置**: 每个xlsx文件创建同名文件夹

### 语音分配
- **分配策略**: 每个xlsx文件使用固定专用语音
- **不重复**: 不同文件使用不同语音
- **可用语音**: 33种不同英语语音

## 📈 性能指标

### 处理速度
- **单线程**: 6-10个音频文件/分钟
- **11线程并行**: 130个音频文件/分钟
- **效率提升**: 7.5倍

### 时间估算
- **单文件**: 约3200行，处理时间约25分钟
- **11文件并行**: 约25分钟 (所有文件同时完成)
- **预计完成**: 根据实际处理速度动态计算

## 🎛️ 配置选项

### 语音配置
```python
available_voices = [
    "en-US-JennyNeural",      # Female - Sincere, Pleasant, Approachable
    "en-US-GuyNeural",        # Male - Light-Hearted, Whimsical, Friendly
    "en-US-AriaNeural",       # Female - Crisp, Bright, Clear
    "en-US-DavisNeural",      # Male - Soothing, Calm, Smooth
    # ... 更多语音选项
]
```

### 处理配置
- **线程数**: 11个线程 (每个文件一个线程)
- **延迟策略**: 每10个文件延迟2秒
- **内存管理**: 逐行处理，避免内存溢出
- **错误恢复**: 跳过错误行，继续处理

## 📊 监控工具

### 统计看板
```bash
# Python版本 (功能完整)
python3 EdgeTTS_统计时间看板.py

# Shell版本 (轻量级)
./EdgeTTS_统计看板.sh
```

### 剩余时间统计
```bash
./EdgeTTS_剩余时间统计器.sh
```

## 🔧 高级功能

### 多API支持
- **API服务**: 支持多个EdgeTTS API服务
- **负载均衡**: 自动分配API服务
- **故障转移**: API服务故障时自动切换

### 智能处理
- **内容清理**: 自动清理英文字段内容
- **质量检查**: 自动检查音频文件质量
- **错误处理**: 完善的错误处理和恢复机制

## 📋 规则说明

### 处理规则
1. **规则1**: 只处理"英文"字段的内容
2. **规则2**: 忽略每个xlsx文件中所有行的Voice字段
3. **规则3**: 每个xlsx文件在输出目录下创建同名文件夹
4. **规则4**: 文件名格式: `english_field_{行号}_{文件专用voice}.mp3`
5. **规则5**: 多文件并行处理，每个文件独立线程
6. **规则6**: 每个xlsx文件使用固定专用voice，不重复

### 文件结构规则
- **输入目录**: `18_批量输入_批量文件输入目录/`
- **输出目录**: `20_输出文件_处理完成的音频文件/`
- **日志目录**: `19_日志文件_系统运行日志和错误记录/`
- **临时目录**: `14_临时文件_运行时生成的文件/`

## 🐛 故障排除

### 常见问题
1. **音频文件过小**: 检查网络连接和EdgeTTS服务状态
2. **处理速度慢**: 检查系统资源和线程数量
3. **语音分配错误**: 检查语音列表配置

### 日志查看
```bash
# 查看TTS服务日志
tail -f 19_日志文件_系统运行日志和错误记录/tts_service.log
```

## 📄 许可证

本项目采用MIT许可证，详见LICENSE文件。

## 🤝 贡献

欢迎提交Issue和Pull Request来改进项目。

## 📞 支持

如有问题，请查看项目文档或提交Issue。

---

**EdgeTTS 多文件并行音频生成系统** - 高效、稳定、易用的TTS批量处理解决方案

#!/bin/bash
# EdgeTTS é¡¹ç›®æ‰“åŒ…è„šæœ¬

set -e

echo "ðŸ“¦ EdgeTTS å¤šæ–‡ä»¶å¹¶è¡ŒéŸ³é¢‘ç”Ÿæˆç³»ç»Ÿ - é¡¹ç›®æ‰“åŒ…"
echo "=========================================="

# èŽ·å–å½“å‰æ—¶é—´æˆ³
timestamp=$(date +"%Y%m%d_%H%M%S")
package_name="EdgeTTS_MultiFile_Parallel_System_${timestamp}"

echo "ðŸ“‹ åˆ›å»ºé¡¹ç›®åŒ…: $package_name"

# åˆ›å»ºä¸´æ—¶æ‰“åŒ…ç›®å½•
temp_dir="/tmp/$package_name"
mkdir -p "$temp_dir"

echo "ðŸ“ å¤åˆ¶é¡¹ç›®æ–‡ä»¶..."

# å¤åˆ¶æ ¸å¿ƒæ–‡ä»¶
cp -r /Volumes/M2/TT_Live_AI_TTS/* "$temp_dir/" 2>/dev/null || true

# è¿›å…¥ä¸´æ—¶ç›®å½•
cd "$temp_dir"

# æ¸…ç†ä¸éœ€è¦çš„æ–‡ä»¶
echo "ðŸ§¹ æ¸…ç†ä¸´æ—¶æ–‡ä»¶..."
rm -rf .git
rm -rf __pycache__
rm -rf *.pyc
rm -rf .DS_Store
rm -rf venv
rm -rf 20_è¾“å‡ºæ–‡ä»¶_å¤„ç†å®Œæˆçš„éŸ³é¢‘æ–‡ä»¶/*
rm -rf 19_æ—¥å¿—æ–‡ä»¶_ç³»ç»Ÿè¿è¡Œæ—¥å¿—å’Œé”™è¯¯è®°å½•/*
rm -rf 14_ä¸´æ—¶æ–‡ä»¶_è¿è¡Œæ—¶ç”Ÿæˆçš„æ–‡ä»¶/*

# åˆ›å»ºé¡¹ç›®ä¿¡æ¯æ–‡ä»¶
echo "ðŸ“ åˆ›å»ºé¡¹ç›®ä¿¡æ¯æ–‡ä»¶..."
cat > PROJECT_INFO.txt << EOF
EdgeTTS å¤šæ–‡ä»¶å¹¶è¡ŒéŸ³é¢‘ç”Ÿæˆç³»ç»Ÿ
================================

é¡¹ç›®ç‰ˆæœ¬: v1.0
æ‰“åŒ…æ—¶é—´: $(date)
æ‰“åŒ…ç‰ˆæœ¬: $timestamp

é¡¹ç›®æè¿°:
é«˜æ•ˆçš„æ–‡æœ¬è½¬è¯­éŸ³(TTS)æ‰¹é‡å¤„ç†å·¥å…·ï¼Œæ”¯æŒå¤šæ–‡ä»¶å¹¶è¡Œå¤„ç†ã€
ä¸°å¯Œè¯­éŸ³é€‰æ‹©ã€å®žæ—¶è¿›åº¦ç›‘æŽ§å’Œå‰©ä½™æ—¶é—´ç»Ÿè®¡ã€‚

æ ¸å¿ƒç‰¹æ€§:
- å¤šæ–‡ä»¶å¹¶è¡Œå¤„ç† (11ä¸ªçº¿ç¨‹)
- 33ç§è‹±è¯­è¯­éŸ³é€‰æ‹©
- å®žæ—¶è¿›åº¦ç›‘æŽ§
- å‰©ä½™æ—¶é—´ç»Ÿè®¡
- è™šæ‹ŸçŽ¯å¢ƒæ”¯æŒ
- ä¸€é”®å®‰è£…éƒ¨ç½²

å®‰è£…è¯´æ˜Ž:
1. è§£åŽ‹é¡¹ç›®æ–‡ä»¶
2. è¿è¡Œ ./install.sh å®‰è£…ä¾èµ–
3. è¿è¡Œ ./start_edgetts.sh å¯åŠ¨ç³»ç»Ÿ

æ–‡ä»¶ç»“æž„:
- EdgeTTS_å¤šæ–‡ä»¶å¹¶è¡Œå¤„ç†å™¨.py: ä¸»å¤„ç†å™¨
- EdgeTTS_ç»Ÿè®¡æ—¶é—´çœ‹æ¿.py: ç»Ÿè®¡çœ‹æ¿
- install.sh: å®‰è£…è„šæœ¬
- start_edgetts.sh: å¯åŠ¨è„šæœ¬
- README.md: è¯¦ç»†è¯´æ˜Žæ–‡æ¡£

æŠ€æœ¯æ”¯æŒ:
å¦‚æœ‰é—®é¢˜è¯·æŸ¥çœ‹ README.md æˆ–æäº¤ Issue

================================
EOF

# åˆ›å»ºåŽ‹ç¼©åŒ…
echo "ðŸ—œï¸  åˆ›å»ºåŽ‹ç¼©åŒ…..."
cd /tmp
tar -czf "${package_name}.tar.gz" "$package_name"

# ç§»åŠ¨åˆ°æ¡Œé¢
mv "${package_name}.tar.gz" ~/Desktop/

echo ""
echo "ðŸŽ‰ é¡¹ç›®æ‰“åŒ…å®Œæˆ!"
echo "=========================================="
echo "ðŸ“¦ æ‰“åŒ…æ–‡ä»¶: ~/Desktop/${package_name}.tar.gz"
echo "ðŸ“ é¡¹ç›®å¤§å°: $(du -sh ~/Desktop/${package_name}.tar.gz | cut -f1)"
echo ""
echo "ðŸ“‹ åŒ…å«å†…å®¹:"
echo "âœ… å®Œæ•´çš„é¡¹ç›®æºä»£ç "
echo "âœ… å®‰è£…å’Œå¯åŠ¨è„šæœ¬"
echo "âœ… è¯¦ç»†çš„ä½¿ç”¨æ–‡æ¡£"
echo "âœ… é¡¹ç›®é…ç½®æ–‡ä»¶"
echo "âœ… è™šæ‹ŸçŽ¯å¢ƒæ”¯æŒ"
echo ""
echo "ðŸš€ ä½¿ç”¨æ–¹æ³•:"
echo "1. è§£åŽ‹: tar -xzf ${package_name}.tar.gz"
echo "2. å®‰è£…: cd $package_name && ./install.sh"
echo "3. å¯åŠ¨: ./start_edgetts.sh"
echo ""
echo "ðŸ“– æ›´å¤šä¿¡æ¯è¯·æŸ¥çœ‹ README.md"
echo "=========================================="

# æ¸…ç†ä¸´æ—¶ç›®å½•
rm -rf "$temp_dir"
